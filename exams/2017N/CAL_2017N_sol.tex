\documentclass{cal}
\title{CAL -- Exam 2016/17}
\author{Diogo Miguel Ferreira Rodrigues \\ \email{dmfrodrigues2000@gmail.com}}
\begin{document}

{
\renewcommand{\thechapter}{\arabic{chapter}N}
\setcounter{chapter}{16}
\exam{Exam normal 2016/17}

\question{Question 1}
In a library, you intend to organize a set of $n$ books into shelves. The books' relative order has been predetermined by the librarian and can't be changed. A book $i$ is characterized by its width $L_i$ and height $A_i$. The length of each shelf is $L_P$. The shelves' heights are adjustable, where the height of each shelf is the height of the tallest book. The cost of a particular arrangement is the sum of the heights of all shelves. The intention is to determine the arrangement that minimizes cost.

\questionitem{Item a}
Implement (in C++ or pseudocode) a solution for the problem, using a greedy algorithm. Discuss its optimality and mention its time complexity. Justify.

\ansseparator

\lstinputlisting[language=C++]{2017N_01a.cpp}

This algorithm is not optimal, and this can be proven by a simple example, to which we will find the solution given by the algorithm and then describe a better solution: consider $L_P=2$, $L=\langle 1, 1, 1 \rangle$ and $A = \langle 1, 2, 2 \rangle$. The greedy algorithm would result in the arrangement $shelf=\langle 0, 0, 1 \rangle$ where both shelfs 0 and 1 have height 2, amounting to a total height of 4. However there is a solution $shelf = \langle 0, 1, 1 \rangle$ where shelf 0 has height 1 and shelf 1 has height 2, amounting to a total height of 3. This means there is a better solution that the greedy algorithm has not found, thus it is not optimal

Its time complexity is $O(n)$, since there is only one \textbf{for} loop (with no nested \textbf{for} loops) where all operations are elementary (thus $O(1)$).

\questionitem{Item b}
To describe a solution, we need only two variables:
\begin{itemize}
    \item How many books we have placed so far, $i$
    \item The free width of the current shelf, $w$
\end{itemize}
For each solution we save three pieces of information:
\begin{itemize}
    \item The height of the current shelf, $h$
    \item The total height of the arrangement, excluding the current shelf, $H$
    \item The keys of the previous solution, $(i, w)$
\end{itemize}
The base case is $S_0^0 = (h=0, H=0)$.\\
For each solution $S_i^w$ we can construct two more solutions:
\begin{itemize}
    \item If the shelf still has space (if $w + L_i \leq L_P$), $S_{i+1}^{w+L_i}$ can be $(h' = \max\{h, A_i\}, H'=H)$.
    \item If we decide to put the book in the next shelf, $S_{i+1}^{L_i}$ can be $(h' = A_i, H' = H+h)$.
\end{itemize}
The final solution is
\begin{equation*}
    \min_{0 \leq w \leq L_P}\{S_n^w.H+S_n^w.h\}
\end{equation*}
and the corresponding arrangement can be extracted by traversing the previous solutions.

Its time complexity is $O(n \cdot L_P)$, since there are $n \cdot L_P$ possibly different states, and the processing of one state improves two other solutions in time $O(1)$.

\newpage
\lstinputlisting[language=C++]{2017N_01b.cpp}

\question{Question 2}
Considering graph paths problems, answer the following items. When describing algorithms use pseudocode or C++.

\questionitem{Item a}
Consider the undirected graph in the figure.

\begin{center}
	\begin{tikzpicture}[-,>=stealth',node distance=2cm,initial text=$ $,]
		\node[state](A) {$A$};
		\node[state, above right of=A](B) {$B$};
        \node[state, below of=B](C) {$C$};
        \node[state, above right of=B](G) {$G$};
        \node[state, below right of=G](D) {$D$};
        \node[state, below of=D](E) {$E$};
        \node[state, below right of=D](F) {$F$};

        \draw   (A) 	edge[above] node{1} (B)
                (A) 	edge[below] node{3} (C)
                (A) 	edge[above, bend right=65] node{10} (F)
                (B) 	edge[left ] node{1} (C)
                (B) 	edge[above] node{7} (D)
                (B) 	edge[above left ] node{5} (E)
                (B) 	edge[left ] node{2} (G)
                (C) 	edge[below left ] node{9} (D)
                (C) 	edge[above] node{3} (E)
                (D) 	edge[right] node{2} (E)
                (D) 	edge[above] node{1} (F)
                (D) 	edge[right] node{12} (G)
                (E) 	edge[below] node{2} (F)
                
                
                ;
	\end{tikzpicture}
\end{center}

We want to determine the shortest paths, with origin $A$, generated by applying Dijkstra's algorithm. Show the values of distances of each vertex as they are processed. What is the shortest path from $A$ to $F$?

\ansseparator

Below is a trace of variables used in Dijkstra's algorithm.

\begin{center} \begin{tabular}{r | l l c}
    \textbf{Line} & \textbf{dist} & \textbf{Q} & \textbf{u}\\ \hline
    3             & $\langle \infty, \infty, \infty, \infty, \infty, \infty, \infty \rangle$ & $\{A,B,C,D,E,F,G\}$ & - \\
    4             & $\langle 0, \infty, \infty, \infty, \infty, \infty, \infty \rangle$ & $\{A,B,C,D,E,F,G\}$ & - \\
    5             & $\langle 0, \infty, \infty, \infty, \infty, \infty, \infty \rangle$ & $\{A,B,C,D,E,F,G\}$ & - \\
    8             & $\langle 0, \infty, \infty, \infty, \infty, \infty, \infty \rangle$ & $\{B,C,D,E,F,G\}$ & $A$ \\
    5             & $\langle 0, 1, 3, \infty, \infty, 10, \infty \rangle$ & $\{B,C,D,E,F,G\}$ & $A$ \\
    8             & $\langle 0, 1, 3, \infty, \infty, 10, \infty \rangle$ & $\{C,D,E,F,G\}$ & $B$ \\
    5             & $\langle 0, 1, 2, 8, 6, 10, 3 \rangle$ & $\{C,D,E,F,G\}$ & $B$ \\
    8             & $\langle 0, 1, 2, 8, 6, 10, 3 \rangle$ & $\{D,E,F,G\}$ & $C$ \\
    5             & $\langle 0, 1, 2, 8, 5, 10, 3 \rangle$ & $\{D,E,F,G\}$ & $C$ \\
    8             & $\langle 0, 1, 2, 8, 5, 10, 3 \rangle$ & $\{D,E,F\}$ & $G$ \\
    5             & $\langle 0, 1, 2, 8, 5, 10, 3 \rangle$ & $\{D,E,F\}$ & $G$ \\
    8             & $\langle 0, 1, 2, 8, 5, 10, 3 \rangle$ & $\{D,F\}$ & $E$ \\
    5             & $\langle 0, 1, 2, 7, 5, 7, 3 \rangle$ & $\{D,F\}$ & $E$ \\
    8             & $\langle 0, 1, 2, 7, 5, 7, 3 \rangle$ & $\{F\}$ & $D$ \\
    5             & $\langle 0, 1, 2, 7, 5, 7, 3 \rangle$ & $\{F\}$ & $D$ \\
    8             & $\langle 0, 1, 2, 7, 5, 7, 3 \rangle$ & $\{\}$ & $F$ \\
    5             & $\langle 0, 1, 2, 7, 5, 7, 3 \rangle$ & $\{\}$ & $F$ \\
    12            & $\langle 0, 1, 2, 7, 5, 7, 3 \rangle$ & $\{\}$ & -
\end{tabular} \end{center}

The shortest path from $A$ to $F$ is $A \rightarrow B \rightarrow C \rightarrow E \rightarrow F$, with a total cost of 7.

\newpage
\questionitem{Item b}
Present an efficient algorithm that, given a DAG (directed acyclic graph) with positive edges and vertices $v_i$, $v_f$ abd $v_k$ of that graph, finds the shortest path from $v_i$ to $v_f$ going through $v_k$. Suggestion: change Dijkstra's algorithm.

\ansseparator

\begin{algorithm}[H]
    \caption{2017N-2b}
    \begin{algorithmic}[1]
        \Function{InDegrees}{$G(V,E)$}
            \For{$v \in V$}{ $indegree(v) \gets 0$}
            \EndFor
            \For{$e \in E$}{ $indegree(e.v)++$}
            \EndFor
            \State \Return $indegree$
        \EndFunction
        \Function{TopologicalSort}{$G$}
            \State $indegree \gets \Call{InDegree}{G}$
            \State $Q \gets \{v \in V \mid indegree(v) = 0\}$
            \State $toporder \gets []$
            \While{$|Q| > 0$}
                \State {$u \gets Q.\Call{First}{ }$}
                \State {$Q.\Call{Erase}{u}$}
                \State {$toporder.\Call{Push}{u}$}
                \For {$v \in \Call{Adj}{G, u}$}
                    \State {$--indegree(v)$}
                    \If {$indegree(v) = 0$}{ $Q \gets Q \cup \{v\}$}
                    \EndIf
                \EndFor
            \EndWhile
        \EndFunction
        \State {$Q \gets []$}
        \Function{ShortestPath}{$G(V,E)$, $s$, $d$}
            \For{$v \in V$}
                \State $dist(v) \gets \infty$
                \State $prev(v) \gets \text{NULL}$
            \EndFor
            \State $dist(s) \gets 0$
            \State $i \gets Q.\Call{Find}{s}$
            \While {$i < |Q|$}
                \State {$u \gets Q_i$}
                \State {$++i$}
                \If {$u = d$}{ break}
                \EndIf
                \For {$v \in \Call{Adj}{G, u}$}
                    \State $c' \gets dist(u) + w(u, v)$
                    \If {$c' < dist(v)$}
                        \State{ $dist(v) \gets c'$, $prev(v) \gets u$}
                    \EndIf
                \EndFor
            \EndWhile
            \If{$prev(d) = \text{NULL}$}{ \Return $[]$}
            \EndIf
            \State {$ret \gets []$}
            \While{$d \neq s$}
                \State {$ret.\Call{Push}{d}$}
                \State {$d \gets prev(d)$}
            \EndWhile
            \State \Return $dist$, $prev$
        \EndFunction
        \Function{ShortestPathMid}{$G(V,E)$, $v_i$, $v_f$, $v_k$}
            \State {$Q \gets \Call{TopologicalSort}{G}$}
            \State \Return {$\Call{ShortestPath}{G, v_i, v_k} + \Call{ShortestPath}{G, v_k, v_f}[1:\text{end}]$}
        \EndFunction
    \end{algorithmic}
\end{algorithm}

\newpage
\question{Question 3}
Consider the weighted graph below and answer the following items.

\begin{center}
	\begin{tikzpicture}[-,>=stealth',node distance=2cm,initial text=$ $,]
		\node[state](a) {$a$};
		\node[state, below left of=a](c) {$c$};
		\node[state, below right of=a](d) {$d$};
		\node[state, below right of=c](f) {$f$};
        \node[state, above right of=d](b) {$b$};
        \node[state, below right of=d](g) {$g$};
        \node[state, above right of=g](e) {$e$};

        \draw   (a) 	edge node{2} (c)
                (a) 	edge node{7} (d)
                (b) 	edge node{5} (d)
                (b) 	edge node{3} (e)
                (c) 	edge node{5} (f)
                (d) 	edge node{3} (f)
                (d) 	edge node{6} (e)
                (d) 	edge node{2} (g)
                (e) 	edge node{7} (g)
                ;
	\end{tikzpicture}
\end{center}

\questionitem{Item a}
Mention all articulation points of the graph, if there is any. Explain.

\ansseparator

An articulation point, also known as a cut vertex, is a vertex that, if removed, would disconnect a strongly connected graph.

This graph is strongly connected, so there is a chance there are articulation points.

If $d$ is removed, the graph will become disconnected, having as strongly connected components $\{a,c,f\}$ and $\{b, e, g\}$.

This is the only articulation point, since there is no other vertex that would disconnect the graph when removed.

\questionitem{Item b}
Find an ``optimal Chinese postman path'', starting in vertex $a$. Explain, step by step, the method you used to calculate that path and why it is optimal.

\ansseparator

Step 1: find all vertices of odd degree.

\begin{center}
	\begin{tikzpicture}[-,>=stealth',node distance=2cm,initial text=$ $,]
		\node[state](a) {$a$};
		\node[state, below left of=a](c) {$c$};
		\node[state, below right of=a, fill=gray!75](d) {$d$};
		\node[state, below right of=c](f) {$f$};
        \node[state, above right of=d](b) {$b$};
        \node[state, below right of=d](g) {$g$};
        \node[state, above right of=g, fill=gray!75](e) {$e$};

        \draw   (a) 	edge node{2} (c)
                (a) 	edge node{7} (d)
                (b) 	edge node{5} (d)
                (b) 	edge node{3} (e)
                (c) 	edge node{5} (f)
                (d) 	edge node{3} (f)
                (d) 	edge node{6} (e)
                (d) 	edge node{2} (g)
                (e) 	edge node{7} (g)
                ;
	\end{tikzpicture}
\end{center}

Step 2: Find shortest paths between all pairs of odd-degree vertices.

\begin{center} \begin{tabular}{c | c c}
    $d(u,v)$ & $d$ & $e$ \\ \hline
    $d$      & -   & 6   \\
    $e$      & -   & -
\end{tabular} \end{center}

Step 3: Build a complete graph $G'$ with odd-degree vertices and edges equal to the minimum distances calculated in 2.

\begin{center}
	\begin{tikzpicture}[-,>=stealth',node distance=2cm,initial text=$ $,]
		\node[state](a) {$a$};
		\node[state, fill=gray!75](d) {$d$};
		\node[state, right of=d, fill=gray!75](e) {$e$};

        \draw   (d) 	edge[above] node{6} (e)
                ;
	\end{tikzpicture}
\end{center}

\newpage
Step 4: Find a minimum-weight perfect pairing.

\begin{center}
	\begin{tikzpicture}[-,>=stealth',node distance=2cm,initial text=$ $,]
		\node[state](a) {$a$};
		\node[state, fill=gray!75](d) {$d$};
		\node[state, right of=d, fill=gray!75](e) {$e$};

        \draw   (d) 	edge[above,line width=1.5pt] node{6} (e)
                ;
	\end{tikzpicture}
\end{center}

Step 5: For each pair $(u,v)$ in the perfect pairing, add pseudo-edges to $G$ and call it $G^*$

\begin{center}
	\begin{tikzpicture}[-,>=stealth',node distance=2cm,initial text=$ $,]
		\node[state](a) {$a$};
		\node[state, below left of=a](c) {$c$};
		\node[state, below right of=a, fill=gray!75](d) {$d$};
		\node[state, below right of=c](f) {$f$};
        \node[state, above right of=d](b) {$b$};
        \node[state, below right of=d](g) {$g$};
        \node[state, above right of=g, fill=gray!75](e) {$e$};

        \draw   (a) 	edge node{2} (c)
                (a) 	edge node{7} (d)
                (b) 	edge node{5} (d)
                (b) 	edge node{3} (e)
                (c) 	edge node{5} (f)
                (d) 	edge node{3} (f)
                (d) 	edge[bend left=15] node{6} (e)
                (d) 	edge[bend right=15] node{6} (e)
                (d) 	edge node{2} (g)
                (e) 	edge node{7} (g)
                ;
	\end{tikzpicture}
\end{center}

Step 6: Find an Euler circuit in $G^*$.

\begin{center}
	\begin{tikzpicture}[-,>=stealth',node distance=2cm,initial text=$ $,]
		\node[state](a) {$a$};
		\node[state, below left of=a](c) {$c$};
		\node[state, below right of=a, fill=gray!75](d) {$d$};
		\node[state, below right of=c](f) {$f$};
        \node[state, above right of=d](b) {$b$};
        \node[state, below right of=d](g) {$g$};
        \node[state, above right of=g, fill=gray!75](e) {$e$};

        \draw   (a) 	edge node{1} (c)
                (a) 	edge node{10} (d)
                (b) 	edge node{7} (d)
                (b) 	edge node{6} (e)
                (c) 	edge node{2} (f)
                (d) 	edge node{3} (f)
                (d) 	edge[bend left=15] node{8} (e)
                (d) 	edge[bend right=15] node{9} (e)
                (d) 	edge node{4} (g)
                (e) 	edge node{5} (g)
                ;
	\end{tikzpicture}
\end{center}

$a \rightarrow c \rightarrow f \rightarrow d \rightarrow g \rightarrow e \rightarrow b \rightarrow d \rightarrow e \rightarrow d \rightarrow a$

\question{Question 4}
A country's government decided to build a highway network connecting cities $C_1$, $C_2$, $C_3$, $C_4$, $C_5$, $C_6$ and $C_7$, as shown in the graph.

\begin{center}
	\begin{tikzpicture}[->,>=stealth',node distance=2.5cm,initial text=$ $,]
		\node[state](C1) {$C_1$};
		\node[state, below left of=C1](C2) {$C_2$};
		\node[state, below right of=C1](C3) {$C_3$};
		\node[state, below right of=C2](C4) {$C_4$};
		\node[state, below left of=C4](C5) {$C_5$};
		\node[state, below right of=C4](C6) {$C_6$};
		\node[state, below right of=C5](C7) {$C_7$};
		

        \draw   (C1) 	edge node{A8 (3)} (C2)
                (C1) 	edge node{A5 (2)} (C3)
                (C1) 	edge node{A1 (3)} (C4)
                (C2) 	edge node{A8 (2)} (C5)
                (C3) 	edge node{N1 (2)} (C6)
                (C4) 	edge node{N3 (2)} (C6)
                (C4) 	edge node{A1 (3)} (C7)
                (C5) 	edge node{N7 (2)} (C4)
                (C5) 	edge node{A8 (3)} (C7)
				(C6) 	edge node{A1 (3)} (C7)
                ;
	\end{tikzpicture}
\end{center}

Some parts of the network were classified as \emph{highways} (A) and others as \emph{national roads} (N). In parenthesis are the number of traffic lanes, which limits the maximum number of vehicles that can traverse it --- in the case of highways, each lane admits an hourly volume of 2,000 vehicles, while national road lanes admit only 1,000 vehicles. It has been estimated that the number of hourly travels between $C_1$ and $C_7$ is 18,000 vehicles per hour.

\questionitem{Item a}
Check if the network can sustain the hourly number of estimated travels. Justify.

\ansseparator

This is the actual hourly vehicle maximum flow through each road:

\begin{center}
	\begin{tikzpicture}[->,>=stealth',node distance=2cm,initial text=$ $,]
		\node[state](C1) {$C_1$};
		\node[state, below left of=C1](C2) {$C_2$};
		\node[state, below right of=C1](C3) {$C_3$};
		\node[state, below right of=C2](C4) {$C_4$};
		\node[state, below left of=C4](C5) {$C_5$};
		\node[state, below right of=C4](C6) {$C_6$};
		\node[state, below right of=C5](C7) {$C_7$};
		

        \draw   (C1) 	edge[above] node{6k} (C2)
                (C1) 	edge[above] node{4k} (C3)
                (C1) 	edge[right] node{6k} (C4)
                (C2) 	edge[left ] node{4k} (C5)
                (C3) 	edge[right] node{2k} (C6)
                (C4) 	edge[above] node{2k} (C6)
                (C4) 	edge[right] node{6k} (C7)
                (C5) 	edge[above] node{2k} (C4)
                (C5) 	edge[left ] node{6k} (C7)
				(C6) 	edge[right] node{6k} (C7)
                ;
	\end{tikzpicture}
\end{center}

To reach an answer, we will apply the Edmonds-Karp algorithm, which consists of selecting the shortest augmenting path until there are no augmenting paths. 

\begin{center} \begin{tabular}{c | c | c | c}
    \begin{tikzpicture}[->,>=stealth',node distance=1.7cm,initial text=$ $,]
        \small
        \node[state](C1) {$C_1$};
        \node[state, below left of=C1](C2) {$C_2$};
        \node[state, below right of=C1](C3) {$C_3$};
        \node[state, below right of=C2](C4) {$C_4$};
        \node[state, below left of=C4](C5) {$C_5$};
        \node[state, below right of=C4](C6) {$C_6$};
        \node[state, below right of=C5](C7) {$C_7$};
        

        \draw   (C1) 	edge[above] node{6} (C2)
                (C1) 	edge[above] node{4} (C3)
                (C1) 	edge[right, line width=1.5pt] node{6} (C4)
                (C2) 	edge[left ] node{4} (C5)
                (C3) 	edge[right] node{2} (C6)
                (C4) 	edge[above] node{2} (C6)
                (C4) 	edge[right, line width=1.5pt] node{6} (C7)
                (C5) 	edge[above] node{2} (C4)
                (C5) 	edge[left ] node{6} (C7)
				(C6) 	edge[right] node{6} (C7)
                ;
    \end{tikzpicture} &
    \begin{tikzpicture}[->,>=stealth',node distance=1.7cm,initial text=$ $,]
        \small
        \node[state](C1) {$C_1$};
        \node[state, below left of=C1](C2) {$C_2$};
        \node[state, below right of=C1](C3) {$C_3$};
        \node[state, below right of=C2](C4) {$C_4$};
        \node[state, below left of=C4](C5) {$C_5$};
        \node[state, below right of=C4](C6) {$C_6$};
        \node[state, below right of=C5](C7) {$C_7$};
        

        \draw   (C1) 	edge[above, line width=1.5pt] node{6} (C2)
                (C1) 	edge[above] node{4} (C3)
                (C1) 	edge[bend right=10, left , dashed] node{0} (C4)
                (C4) 	edge[bend right=10, right] node{6} (C1)
                (C2) 	edge[left , line width=1.5pt] node{4} (C5)
                (C3) 	edge[right] node{2} (C6)
                (C4) 	edge[above] node{2} (C6)
                (C4) 	edge[bend right=10, left , dashed] node{0} (C7)
                (C7) 	edge[bend right=10, right] node{6} (C4)
                (C5) 	edge[above] node{2} (C4)
                (C5) 	edge[left , line width=1.5pt] node{6} (C7)
                (C6) 	edge[right] node{6} (C7)
                ;
    \end{tikzpicture} & 
    \begin{tikzpicture}[->,>=stealth',node distance=1.7cm,initial text=$ $,]
        \small
        \node[state](C1) {$C_1$};
        \node[state, below left of=C1](C2) {$C_2$};
        \node[state, below right of=C1](C3) {$C_3$};
        \node[state, below right of=C2](C4) {$C_4$};
        \node[state, below left of=C4](C5) {$C_5$};
        \node[state, below right of=C4](C6) {$C_6$};
        \node[state, below right of=C5](C7) {$C_7$};
        

        \draw   (C1) 	edge[bend right=10, left ] node{2} (C2)
                (C2) 	edge[bend right=10, below] node{4} (C1)
                (C1) 	edge[above, line width=1.5pt] node{4} (C3)
                (C1) 	edge[bend right=10, left , dashed] node{0} (C4)
                (C4) 	edge[bend right=10, right] node{6} (C1)
                (C2) 	edge[bend right=10, left , dashed] node{0} (C5)
                (C5) 	edge[bend right=10, right] node{4} (C2)
                (C3) 	edge[right, line width=1.5pt] node{2} (C6)
                (C4) 	edge[above] node{2} (C6)
                (C4) 	edge[bend right=10, left , dashed] node{0} (C7)
                (C7) 	edge[bend right=10, right] node{6} (C4)
                (C5) 	edge[above] node{2} (C4)
                (C5) 	edge[bend right=10, left ] node{2} (C7)
                (C7) 	edge[bend right=10, above] node{4} (C5)
                (C6) 	edge[right, line width=1.5pt] node{6} (C7)
                ;
    \end{tikzpicture} & 
    \begin{tikzpicture}[->,>=stealth',node distance=1.7cm,initial text=$ $,]
        \small
        \node[state](C1) {$C_1$};
        \node[state, below left of=C1](C2) {$C_2$};
        \node[state, below right of=C1](C3) {$C_3$};
        \node[state, below right of=C2](C4) {$C_4$};
        \node[state, below left of=C4](C5) {$C_5$};
        \node[state, below right of=C4](C6) {$C_6$};
        \node[state, below right of=C5](C7) {$C_7$};
        

        \draw   (C1) 	edge[bend right=10, left ] node{2} (C2)
                (C2) 	edge[bend right=10, below] node{4} (C1)
                (C1) 	edge[bend right=10, below] node{2} (C3)
                (C3) 	edge[bend right=10, right] node{2} (C1)
                (C1) 	edge[bend right=10, left , dashed] node{0} (C4)
                (C4) 	edge[bend right=10, right] node{6} (C1)
                (C2) 	edge[bend right=10, left , dashed] node{0} (C5)
                (C5) 	edge[bend right=10, right] node{4} (C2)
                (C3) 	edge[bend right=10, left , dashed] node{0} (C6)
                (C6) 	edge[bend right=10, right] node{2} (C3)
                (C4) 	edge[above] node{2} (C6)
                (C4) 	edge[bend right=10, left , dashed] node{0} (C7)
                (C7) 	edge[bend right=10, right] node{6} (C4)
                (C5) 	edge[above] node{2} (C4)
                (C5) 	edge[bend right=10, left ] node{2} (C7)
                (C7) 	edge[bend right=10, above] node{4} (C5)
                (C6) 	edge[bend right=10, above] node{4} (C7)
                (C7) 	edge[bend right=10, right] node{2} (C6)
                ;
    \end{tikzpicture} \\
    &
    Total flow: 6k &
    Total flow: 10k &
    Total flow: 12k
\end{tabular} \end{center}

As we can see, the maximum hourly vehicle flow from $C_1$ to $C_7$ is 12,000 vehicles, so the network cannot sustain the hourly number of estimated travels of 18,000 vehicles per hour.

\questionitem{Item b}
If the govenment allowed a company to explore the network by charging road tolls in one of the roads, which would be the most profitable? Justify.

\ansseparator

The expected behaviour when a toll is installed is for travellers to avoid that road as much as possible, so we are looking for the road that, when tolled, gives the most profit (i.e., has the most hourly vehicle flow) taking into account travellers will try to avoid it at all cost.

By the previous item, we can visualize this graph as a bipartite graph, where the source subgraph is $\{C_1, C_2, C_3\}$, the sink subgraph is $\{C_4, C_5, C_6, C_7\}$ and the edges that cross from source to sink subgraphs are $C_2 \rightarrow C_5$ (4k), $C_1 \rightarrow C_4$ (6k) and $C_3 \rightarrow C_6$ (2k). Since these three edges are thus unavoidable if the flow is 12k (the maximum the network can sustain), we will be looking forward to toll one of these roads.

Now we just need to choose the one with the most hourly car flow, so the final answer is $C_1 \rightarrow C_4$, with a capacity of 6k vehicles per hour.

\question{Question 5}
The genetic code uses 4 letters (A, C, G, T) to code the bases that make up DNA. Gene XPTO is made of the following base sequence, and respective letter frequency:
\begin{center}\begin{tabular}{c c}
    A A G G T A C C T A C C C C C C C C C C C A & (5 A's, 13 C's, 2 G's, 2 T's)
\end{tabular}\end{center}

\questionitem{Item a}
Considering a coding system of fixed size, what is the smallest code, enough to represent the alphabet? What is the size, in bits, to code gene XPTO? Explain.

\ansseparator

Since the alphabet has $N=4$ letters we need $\lceil \log_2 {N} \rceil \SI{}{\bit} = \lceil 2 \rceil \SI{}{\bit} = \SI{2}{\bit}$ bits to represent each letter in the alphabet. To encode gene XPTO, we would need $\SI{2}{\bit}*22=\SI{44}{\bit}$.

\questionitem{Item b}
Considering variable-length codes, what is the least total cost of coding gene XPTO? Explain in detail.

\ansseparator

To find the least total cost of coding gene XPTO, we will use Huffman encoding, as it theoretically provides the least cost coding. This algorithm assigns longer codes to less frequent characters, and shorter codes to more frequent characters.

In this case, we already have the frequencies, so we can immediately build the binary tree, by successively joining less-frequent characters:

\begin{center} \begin{tabular}{P{75mm} | P{75mm}}
    \begin{tikzpicture}[-,>=stealth',node distance=1.2cm,initial text=$ $,]
        \small
        \node[state            , label=above:{13}](C) {$C$};
        \node[state, right of=C, label=above: {5}](A) {$A$};
        \node[state, right of=A, label=above: {2}](G) {$G$};
        \node[state, right of=G, label=above: {2}](T) {$T$};

        \draw   
                ;
    \end{tikzpicture} &
    \begin{tikzpicture}[-,>=stealth',node distance=1.2cm,initial text=$ $,]
        \small
        \node[state                   , label=above:{13}](C) {$C$};
        \node[state, right of=C       , label=above: {5}](A) {$A$};
        \node[state, right of=A       , label=above: {2}](G) {$G$};
        \node[state, above right of=G , label=above: {4}](T1) {$T_1$};
        \node[state, below right of=T1, label=above: {2}](T) {$T$};
        

        \draw   (T1) 	edge (G)
                (T1) 	edge (T)
                ;
    \end{tikzpicture} \\[5pt]
    \begin{tikzpicture}[-,>=stealth',node distance=1.2cm,initial text=$ $,]
        \small
        \node[state                   , label=above:{13}](C) {$C$};
        \node[state, right of=C       , label=above: {5}](A) {$A$};
        \node[state, right of=A       , label=above: {2}](G) {$G$};
        \node[state, above right of=G , label=above: {4}](T1) {$T_1$};
        \node[state, below right of=T1, label=above: {2}](T) {$T$};
        \node[state, above left  of=T1, label=above: {9}](T2) {$T_2$};

        \draw   (T1) 	edge (G)
                (T1) 	edge (T)
                (T2) 	edge (A)
                (T2) 	edge (T1)
                ;
    \end{tikzpicture} & 
    \begin{tikzpicture}[-,>=stealth',node distance=1.2cm,initial text=$ $,]
        \small
        \node[state                   , label=above:{13}](C) {$C$};
        \node[state, right of=C       , label=above: {5}](A) {$A$};
        \node[state, right of=A       , label=above: {2}](G) {$G$};
        \node[state, above right of=G , label=above: {4}](T1) {$T_1$};
        \node[state, below right of=T1, label=above: {2}](T) {$T$};
        \node[state, above left  of=T1, label=above: {9}](T2) {$T_2$};
        \node[state, above left  of=T2, label=above:{22}](T3) {$T_3$};

        \draw   (T1) 	edge (G)
                (T1) 	edge (T)
                (T2) 	edge (A)
                (T2) 	edge (T1)
                (T3) 	edge (C)
                (T3) 	edge (T2)
                ;
    \end{tikzpicture}
\end{tabular} \end{center}

\newpage
This means the encoding table is

\begin{center} \begin{tabular}{c | l}
    \textbf{Character} & \textbf{Code} \\ \hline
    C & 0 \\
    A & 10 \\
    G & 110 \\
    T & 111 \\
\end{tabular} \end{center}

Thus, gene XPTO is encoded to

\begin{center}
    10 10 110 110 111 10 0 0 111 10 0 0 0 0 0 0 0 0 0 0 0 10
\end{center}

which has a length of $5*\SI{2}{\bit} + 13*\SI{1}{\bit} + 2*\SI{3}{\bit} + 2*\SI{3}{\bit} = \SI{35}{\bit}$, which is an improvement compared to $\SI{44}{\bit}$ by constant-length codes.

\question{Question 6}
In an informatics summer camp, several interesting courses are offered to participants, and are taught by internationally recognized lecturers from well known universities and companies. Participants can sign up for several of those courses, without limitation as to the number of courses they choose. In the meanwhile, participants will only have course certificates for those they are approved in the final exam. Considering all final exams last one hour, and are only made once, students from different courses cannot have overlapping exams. Is it possible to implement an efficient algorithm to determine the least number of 1-hour slots so as to avoid students signed up in several courses to have overlapping exams?

Considering this problem, answer the following items:

\questionitem{Item a}
Rewrite this problem as a decision problem.

\ansseparator

Given a set of students and a set of exams for each student, as well as a number $N$, is there an acceptable exam schedule (no student has overlapping exams) that takes less than or $N$ 1-hour slots?

\questionitem{Item b}
Check if there is an efficient solution to this problem, explaining the steps of your solution.

\ansseparator

This problem is NP-complete since:
\begin{itemize}
    \item It is NP, as a solution for the decision problem can be checked in polynomial time; one has to (1) check the number of slots is less or equal to $N$, and (2) for each student assert he/she does not have exams taking place in the same slot.
    \item It is NP-hard, as the graph colouring decision problem ($k$ colours) is reducible to this problem in polynomial time (if there is a solution to this problem then there is also a solution for graph colouring; thus this problem is at least as hard as the graph colouring problem):
    \begin{itemize}
        \item \textbf{Input conversion:} a node in graph colouring is an exam; an edge in graph colouring is a student; the maximum $k$ colours in graph colouring are the maximum $k$ 1-hour slots we can use in our decision problem's witness.
        \item \textbf{Output conversion:} a 1-hour slot is a color in graph colouring.
        \item Similarly to the graph colouring restriction that an edge cannot start and end in vertices of the same color, a student cannot have two exams in the same 1-hour slot.
    \end{itemize}
\end{itemize}


}

\end{document}
